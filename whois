#!/bin/sh
exec ${PERL-perl} -Swx $0 ${1+"$@"}
#!perl

# $Id: whois,v 1.7 2000/12/03 11:17:49 friedman Exp $

my $whois = "jwhois";
system ("{ jwhois --version; } > /dev/null 2>&1");
if ($? != 0)
  {
    $whois = `run-next -p "$0"`;
    chop $whois;
  }

open (F, "$whois @ARGV |");
$/ = undef;
my $buf = <F>;
close (F);

my @s
  = ("The Data in Network Solutions.*abide by this policy.\n+",
     ".*www.nic.fr/info/whois/dbcopyright.html\n+",
     "The ARIN Registration Services Host.*NIPRNET Information.\n+",

     # whois.dotster.com preamble
     "The data contained in Dotster.*limitations of warranty.\n+",
     # whois.dotster.com postamble
     "Register a domain name at www.dotster.com\n+",

     # whois.register.com preamble
     "The data in Register.com.s WHOIS.*abide by these terms.\n+",
     # whois.register.com postamble
     "Register your domain name at http://www.register.com\n+",

     # Compuserve preamble
     "Access to CompuServe.s WHOIS.*you agree to these terms.\n+",
     # Compuserv postamble
     "WHOIS data is only provided.*http://domain.compuserve.com\n+",

     # whois.gandi.net preamble
     "% GANDI Registrar whois database for.*%[^\n]*\n+",
    );

my $r;
foreach $r (@s)
  {
    $buf =~ s/$r//s;
  }
print $buf;
